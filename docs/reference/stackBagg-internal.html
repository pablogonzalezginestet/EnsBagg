<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Algorithm 2:  Procedure to obtain optimally the coefficients to be used in Algorithm 1 — ipcw_ensbagg • stackBagg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Algorithm 2:  Procedure to obtain optimally the coefficients to be used in Algorithm 1 — ipcw_ensbagg" />
<meta property="og:description" content="Obtain predictions
Obtain predictions
Compute weighted Brier Loss function for a single marker or a linear weighted combination of markers
Compute weighted Cross Entropy Loss function for a single marker or a linear weighted combination of markers
Obtain the lambda hyparameter for the LASSO using cross-validation
Internal stackBagg helper functions
Compute the risk of missclassifying an individual using as a marker a single prediction or weighted linear combination of several predictions (1-AUC)
Predictions based on a library of Machine Learning procedures
Library of Machine Learning procedures
Predictions based on those Machine Learning procedures in the library that allow for weights to be specified as an argument of the R function. No bagging occurs. This group of algorithms is denoted as  Native Weights
Library of Machine Learning procedures that allows for weights
A grid of values for hyperparameters used in the Real Data Application: InfCareHIV Register. This grid of values isan argument in the tuning parameter function tune_parameter_ml.R" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stackBagg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Bone_Marrow_Transplant_Data.html">Bone Marrow Transplant Data Set</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction to stackBagg package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Algorithm 2:  Procedure to obtain optimally the coefficients to be used in Algorithm 1</h1>
    
    <div class="hidden name"><code>stackBagg-internal.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Obtain predictions</p>
<p>Obtain predictions</p>
<p>Compute weighted Brier Loss function for a single marker or a linear weighted combination of markers</p>
<p>Compute weighted Cross Entropy Loss function for a single marker or a linear weighted combination of markers</p>
<p>Obtain the lambda hyparameter for the LASSO using cross-validation</p>
<p>Internal stackBagg helper functions</p>
<p>Compute the risk of missclassifying an individual using as a marker a single prediction or weighted linear combination of several predictions (1-AUC)</p>
<p>Predictions based on a library of Machine Learning procedures</p>
<p>Library of Machine Learning procedures</p>
<p>Predictions based on those Machine Learning procedures in the library that allow for weights to be specified as an argument of the R function. No bagging occurs. This group of algorithms is denoted as  Native Weights</p>
<p>Library of Machine Learning procedures that allows for weights</p>
<p>A grid of values for hyperparameters used in the Real Data Application: InfCareHIV Register. This grid of values isan argument in the tuning parameter function tune_parameter_ml.R</p>
    </div>

    <pre class="usage"><span class='fu'>ipcw_ensbagg</span>(<span class='no'>folds</span>, <span class='no'>MLprocedures</span>, <span class='no'>fmla</span>, <span class='no'>tuneparams</span>, <span class='no'>tao</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>A</span>,
  <span class='no'>data</span>, <span class='no'>xnam</span>, <span class='no'>xnam.factor</span>, <span class='no'>xnam.cont</span>, <span class='no'>xnam.cont.gam</span>, <span class='no'>ens.library</span>)

<span class='fu'>ipcw_genbagg</span>(<span class='no'>fmla</span>, <span class='no'>tuneparams</span>, <span class='no'>MLprocedures</span>, <span class='no'>traindata</span>, <span class='no'>testdata</span>, <span class='no'>B</span>, <span class='no'>A</span>,
  <span class='no'>xnam</span>, <span class='no'>xnam.factor</span>, <span class='no'>xnam.cont</span>, <span class='no'>xnam.cont.gam</span>, <span class='no'>ens.library</span>)

<span class='fu'>ipcw_brier</span>(<span class='no'>par</span>, <span class='no'>Z</span>, <span class='no'>y</span>, <span class='no'>wts</span>)

<span class='fu'>ipcw_crossentropy</span>(<span class='no'>par</span>, <span class='no'>Z</span>, <span class='no'>y</span>, <span class='no'>wts</span>)

<span class='fu'>tune_lasso</span>(<span class='no'>folds</span>, <span class='no'>fmla</span>, <span class='no'>tao</span>, <span class='no'>data</span>, <span class='no'>xnam</span>)

<span class='fu'>optimun_auc_coef</span>(<span class='no'>coef_init</span>, <span class='no'>lambda</span>, <span class='no'>data</span>, <span class='no'>Z</span>, <span class='no'>tao</span>)

<span class='fu'>risk_auc</span>(<span class='no'>par</span>, <span class='no'>lambda</span>, <span class='no'>Z</span>, <span class='no'>data</span>, <span class='no'>tao</span>)

<span class='fu'>MLprocedures</span>(<span class='no'>traindata</span>, <span class='no'>testdata</span>, <span class='no'>fmla</span>, <span class='no'>xnam</span>, <span class='no'>xnam.factor</span>, <span class='no'>xnam.cont</span>,
  <span class='no'>xnam.cont.gam</span>, <span class='no'>tuneparams</span>, <span class='no'>ens.library</span>, <span class='no'>i</span>)

<span class='no'>ML_list</span>

<span class='fu'>MLprocedures_natively</span>(<span class='no'>traindata</span>, <span class='no'>testdata</span>, <span class='no'>fmla</span>, <span class='no'>xnam</span>, <span class='no'>xnam.factor</span>,
  <span class='no'>xnam.cont</span>, <span class='no'>xnam.cont.gam</span>, <span class='no'>tuneparams</span>)

<span class='no'>ML_list_natively</span>

<span class='fu'>grid_parametersDataHIV</span>(<span class='no'>xnam</span>, <span class='no'>data</span>, <span class='no'>tao</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>folds</th>
      <td><p>Number of folds</p></td>
    </tr>
    <tr>
      <th>MLprocedures</th>
      <td><p>MLprocedures</p></td>
    </tr>
    <tr>
      <th>fmla</th>
      <td><p>formula object ex. "E ~ x1+x2"</p></td>
    </tr>
    <tr>
      <th>tuneparams</th>
      <td><p>a list of tune parameters for each machine learning procedure</p></td>
    </tr>
    <tr>
      <th>tao</th>
      <td><p>time point of interest</p></td>
    </tr>
    <tr>
      <th>B</th>
      <td><p>number of bootstrap samples</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a training data set</p></td>
    </tr>
    <tr>
      <th>xnam</th>
      <td><p>all covariates in the model</p></td>
    </tr>
    <tr>
      <th>xnam.factor</th>
      <td><p>categorical variables include in the model</p></td>
    </tr>
    <tr>
      <th>xnam.cont</th>
      <td><p>continous variables include in the model</p></td>
    </tr>
    <tr>
      <th>xnam.cont.gam</th>
      <td><p>continous variables to be included in the smoothing operator gam::s(,df)</p></td>
    </tr>
    <tr>
      <th>ens.library</th>
      <td><p>algorithms in the library</p></td>
    </tr>
    <tr>
      <th>traindata</th>
      <td><p>a training data set</p></td>
    </tr>
    <tr>
      <th>testdata</th>
      <td><p>a test data set</p></td>
    </tr>
    <tr>
      <th>par</th>
      <td><p>a vector of weights. Its length must be equal to the number of predictions included in Z</p></td>
    </tr>
    <tr>
      <th>Z</th>
      <td><p>a matrix that contains the predictions. Each column represents a single marker.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>vector of response variable (binary).</p></td>
    </tr>
    <tr>
      <th>wts</th>
      <td><p>IPC weights</p></td>
    </tr>
    <tr>
      <th>coef_init</th>
      <td><p>starting values for the coefficients</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>penalization term. It is a positive scalar.</p></td>
    </tr>
    <tr>
      <th>i</th>
      <td><p>sample selected by bootstrap</p></td>
    </tr>
    <tr>
      <th>fmla</th>
      <td><p>formula object ex. "E ~ x1+x2"</p></td>
    </tr>
    <tr>
      <th>tuneparams</th>
      <td><p>a list of tune parameters for each machine learning procedure</p></td>
    </tr>
    <tr>
      <th>MLprocedures</th>
      <td><p>MLprocedures</p></td>
    </tr>
    <tr>
      <th>B</th>
      <td><p>number of bootstrap samples</p></td>
    </tr>
    <tr>
      <th>xnam</th>
      <td><p>all covariates in the model</p></td>
    </tr>
    <tr>
      <th>xnam.factor</th>
      <td><p>categorical variables include in the model</p></td>
    </tr>
    <tr>
      <th>xnam.cont</th>
      <td><p>continous variables include in the model</p></td>
    </tr>
    <tr>
      <th>xnam.cont.gam</th>
      <td><p>continous variables to be included in the smoothing operator gam::s(,df=)</p></td>
    </tr>
    <tr>
      <th>ens.library</th>
      <td><p>algorithms in the library</p></td>
    </tr>
    <tr>
      <th>par</th>
      <td><p>a vector of weights. Its length must be equal to the number of predictions included in Z</p></td>
    </tr>
    <tr>
      <th>Z</th>
      <td><p>a matrix that contains the predictions. Each column represents a single marker.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>vector of response variable (binary).</p></td>
    </tr>
    <tr>
      <th>wts</th>
      <td><p>IPC weights</p></td>
    </tr>
    <tr>
      <th>folds</th>
      <td><p>number of folds</p></td>
    </tr>
    <tr>
      <th>fmla</th>
      <td><p>formula object ex. "E ~ x1+x2"</p></td>
    </tr>
    <tr>
      <th>tao</th>
      <td><p>time point of interest</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a training data set</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data frame that contains at least: ttilde, delta, wts</p></td>
    </tr>
    <tr>
      <th>Z</th>
      <td><p>a matrix that contains the predictions. Each column represents a single marker.</p></td>
    </tr>
    <tr>
      <th>tao</th>
      <td><p>time point of interest</p></td>
    </tr>
    <tr>
      <th>par</th>
      <td><p>a vector of coefficients/weights. Its length must be equal to the number of predictions included in Z</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>penalization term. It is a positive scalar.</p></td>
    </tr>
    <tr>
      <th>Z</th>
      <td><p>a matrix that contains the predictions. Each column represents a single marker.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data frame  that constains at least: ttilde= time to event, delta=event type, wts= IPC weights</p></td>
    </tr>
    <tr>
      <th>tao</th>
      <td><p>time point of interest</p></td>
    </tr>
    <tr>
      <th>traindata</th>
      <td><p>training data set</p></td>
    </tr>
    <tr>
      <th>testdata</th>
      <td><p>validation/test data set</p></td>
    </tr>
    <tr>
      <th>fmla</th>
      <td><p>formula object ex. "E ~ x1+x2"</p></td>
    </tr>
    <tr>
      <th>tuneparams</th>
      <td><p>a list of tune parameters for each machine learning procedure</p></td>
    </tr>
    <tr>
      <th>traindata</th>
      <td><p>training data set</p></td>
    </tr>
    <tr>
      <th>testdata</th>
      <td><p>validation/test data set</p></td>
    </tr>
    <tr>
      <th>fmla</th>
      <td><p>formula object ex. "E ~ x1+x2"</p></td>
    </tr>
    <tr>
      <th>tuneparams</th>
      <td><p>a list of tune parameters for each machine learning procedure</p></td>
    </tr>
    <tr>
      <th>xnam</th>
      <td><p>a vector with the covariates names considered in the modeling</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a training data set</p></td>
    </tr>
    <tr>
      <th>tao</th>
      <td><p>time point of interest</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p>An object of class <code>list</code> of length 8.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list with the predictions of each machine learning algorithm (id, predictions), the average AUC across folds for each of them, the optimal coefficients, an indicator if the optimization procedure has converged and the value of penalization term chosen</p>
<p>a matrix with the predictions on the test data set of each machine learning algorithm considered in MLprocedures</p>
<p>lambda to be used in the glmnet function</p>
<p>a vector with the optimal AUC value and the optimal coefficient</p>
<p>1-AUC</p>
<p>a matrix of predictions where each column is the prediction of each algorithm based on the testdata</p>
<p>a list of Machine Learning functions</p>
<p>a matrix of predictions where each column is the prediction of each algorithm based on the testdata</p>
<p>a list of Machine Learning functions</p>
<p>a list with a grid of values for each hyperparameter
 gam_param a vector containing degree of freedom 3 and 4
 lasso_param a grid of values for the shrinkage term lambda
 randomforest_param a two column matrix: first column denotes the num_trees parameter and the second column denotes the mtry parameter.
 knn_param a grid of  positive integers values
 svm_param a three column matrix:  first column denotes the cost parameter, second column the gamma and third column the kernel. kernel=1 denotes "radial" and kernel=2 denotes "linear".
nn_param a grid of positive integers values for the neurons
 bart_param a three column matrix:  first column denotes the num_tree parameter, second column the k parameter and third column the q parameter.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>These functions are not intended for use by users.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#format">Format</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Pablo Gonzalez Ginestet.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


