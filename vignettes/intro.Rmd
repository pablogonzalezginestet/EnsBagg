---
title: "Introduction to ensBagg package"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to ensBagg package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```



## Introduction

This vignette focuses on giving an overview of the main functions of the package. This vignette uses the simulated data which ships with the package.  


## Setup

We load the package __ensBagg__ 

```{r, eval=FALSE}
library(ensBagg)
```

## Example: Simulated Data

The simulated data can be loaded via:

```{r}
library(ensBagg)
data("exampleData")
```

__exampleData__ is a list with three elements. The first elemenent contains the training data set and the second element contains the test data set. The data set train and test consist of the variables id, the binary outcome E, the event times denoted as ttilde, delta as the event indicator at ttilde (censored
observations are denoted by the value 0), the trueT which denotes the binary outcome under no censoring and lastly 20 covariates:

```{r}
train <- exampleData[[1]][[1]]
head(train)
```

```{r}
test <- exampleData[[2]][[1]]
head(test)
```

There is a third element __exampleData__ which is the true AUC for the simulated data  on the cumulative incidence of the
main event at time 26.5 computed analytically under the Weibull distribution using the scale and shape parameter for both event times.

```{r}
auc_true <- exampleData[[3]][[1]]
auc_true
```

The train data set consists in 800 individuals where 167 are censored and 180 experience the event of interest at time 26.5:
```{r}
n_train<- dim(train)[1]
n_train
summary(train$E)
```
and 51 subjects experience the competing event within the time of interest 26.5. These individuals are part of the control group.
````{r}
library(dplyr)
train %>% subset(E==0 & ttilde<26.5) %>%  count(delta)
````


The test data set consists in 200 individuals where 45 are censored and 39 experience the event of interest: 
```{r}
n_test<- dim(test)[1]
n_test
summary(test$E)
```

and there are 24 subjects that experience the competing event  within the time of interest 26.5:
````{r}
library(dplyr)
test %>% subset(E==0 & ttilde<26.5) %>%  count(delta)
````

Next we apply __ensBagg__ to estimate the risk of experiencing the main event using the 20 covariates in the data set. In other words, using __ensBagg__ we are going to estimate $P(T<26.5,\delta=1|X)$ using a bunch of machine learning algorithms.
Before applying __ensBagg__, we need to make sure that the data set is in the appropiate format: time event is in the first column and the second column is the indicator event type. 

#### Note: The first two columns of the data.frame data set must be in the following order: time and then status/event indicator

````{r}


````


